<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><title>Ruby女孩(13)：到底字串跟符號什麼時候使用比較好？</title><meta content="Ruby女孩(13)：到底字串跟符號什麼時候使用比較好？" name="title" /><meta content="Ruby女孩(13)：到底字串跟符號什麼時候使用比較好？" property="og:title" /><meta content="Ruby女孩(13)：到底字串跟符號什麼時候使用比較好？" name="twitter:title" /><meta content="http://blog.annideas.com/ironman/2014-10-13-ruby-girl-13-ruby-string-vs-symbol/" name="url" /><meta content="http://blog.annideas.com/ironman/2014-10-13-ruby-girl-13-ruby-string-vs-symbol/" property="og:url" /><meta content="我是 Annie，我參加 iThome 在 2014 年舉辦的第七屆 iT 邦幫忙鐵人賽，連續 30 天不中斷地記錄自己學習 Ruby 的歷程，這一系列 30 篇文章，推薦給跟我一樣初學 Ruby 約半年的朋友參考。" name="description" /><meta content="我是 Annie，我參加 iThome 在 2014 年舉辦的第七屆 iT 邦幫忙鐵人賽，連續 30 天不中斷地記錄自己學習 Ruby 的歷程，這一系列 30 篇文章，推薦給跟我一樣初學 Ruby 約半年的朋友參考。" property="og:description" /><meta content="我是 Annie，我參加 iThome 在 2014 年舉辦的第七屆 iT 邦幫忙鐵人賽，連續 30 天不中斷地記錄自己學習 Ruby 的歷程，這一系列 30 篇文章，推薦給跟我一樣初學 Ruby 約半年的朋友參考。" itemprop="description" /><meta content="我是 Annie，我參加 iThome 在 2014 年舉辦的第七屆 iT 邦幫忙鐵人賽，連續 30 天不中斷地記錄自己學習 Ruby 的歷程，這一系列 30 篇文章，推薦給跟我一樣初學 Ruby 約半年的朋友參考。" name="twitter:description" /><meta content="2014-10-13 08:58 UTC" property="article:published_time" /><meta content="article" name="type" /><meta content="article" property="og:type" /><meta content="838413066169349" property="fb:app_id" /><meta content="zh_TW" property="og:locale" /><meta content="Annideas?" itemprop="name" /><meta content="Annideas?" property="og:site_name" /><meta content="https://www.facebook.com/OtiAnn" property="article:author" /><meta content="@_OtiAnn" name="twitter:site" /><meta content="summary_large_image" name="twitter:card" /><meta content="@_OtiAnn" name="twitter:creator" /><meta content="width=device-width; initial-scale=1.0" name="viewport" /><link href="/stylesheets/application-1dd56025.css" rel="stylesheet" /><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script><script src="/javascripts/application-139c3f48.js"></script><link href="/images/icon-f0edf780.png" rel="shortcut icon" /></head><body class="ironman ironman_2014-10-13-ruby-girl-13-ruby-string-vs-symbol ironman_2014-10-13-ruby-girl-13-ruby-string-vs-symbol_index"><div class="wrapper"><a class="go_home_logo" href="/"><img src="/images/go_home_logo-55ba1e01.png" /><h1 class="title">Annideas?</h1></a><div class="container"><div class="articleContent"><div class="articleContent-category"><a href="/ironman7">鐵 人</a></div><div class="articleContent-title">Ruby女孩(13)：到底字串跟符號什麼時候使用比較好？</div><div class="articleContent-date">2014．Oct．13</div><div class="articleContent-article tp-in-content"><p>還記得前天，我們在說雜湊(Hash)的時候，有提到雜湊的鍵(key)可以用字串(string)或符號(symbol)來表示，例如：</p>

<pre class="highlight ruby"><code><span class="n">hash1</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Annie"</span><span class="p">,</span> <span class="s2">"age"</span> <span class="o">=&gt;</span> <span class="mi">25</span> <span class="p">}</span>  
<span class="n">hash2</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"Ruby"</span><span class="p">,</span> <span class="ss">:age</span> <span class="o">=&gt;</span> <span class="mi">21</span> <span class="p">}</span>  
</code></pre>

<p>那篇文章一直強調<code>"string"</code>與<code>:symbol</code>是不一樣的，那到底哪裡不一樣呢？其實有位厲害的鐵人賽選手在<a href="http://ithelp.ithome.com.tw/articles/10159329">那篇文章下的留言</a>回答了！講得非常清楚噢！快去看快去看，然後我今天的文章就打完了(大誤)XD</p>

<p>從文章留言以及<a href="https://www.ruby-lang.org/zh_tw/documentation/ruby-from-other-languages/">Ruby 中文官方網站</a>中，我們可以得到以下結論：</p>

<p><strong>「到底什麼時候使用symbol、什麼時候使用string呢？」</strong></p>

<p>由於相同名字的symbol 在記憶體裡都占同一個位置，也就是指向同一個物件，所以適用於識別物件，就像是身分證字號一樣，是獨一無二的，永遠不會改變。而每一個string(就算名字一樣)，在記憶體中都是不同位置，適用於可改變的內容，例如綽號、電話…等，就不適合拿來作為識別用途。</p>

<p>總而言之(丸尾上身)：</p>

<p><strong>如果是物件的識別(例如hash中的key)，用symbol。</strong></p>

<p><strong>如果是物件的內容(例如hash中的value)，用string。</strong></p>

<p>好的，我們還是來看一看書中對於符號的說明(p.74)：</p>

<blockquote>
  <p>『Ruby 解譯器的典型石作品會維護一份符號表(symbol table)，把解譯器已經知道的類別、方法和變數之名稱全都存放在此表中。』</p>
</blockquote>

<p>路過的阿嬤問：『阿這嘸蝦咪好康呢？』</p>

<blockquote>
  <p>『這讓解譯器得以避免大部份的字串比較工作，例如：解譯器在指稱方法名稱時可透過其在符號表中的位置。這將代價較高的字串運算轉換成了代價較低的整數運算。』</p>
</blockquote>

<p>路過的阿嬤問：『工蝦啦？』</p>

<p>我想這段的意思，就是指symbol的效能會比string好，因為symbol表中所有東西都有固定的位置，找得比較快，而字串還得去找他在哪，效能就會比較低了。</p>

<p>另外符號的寫法也不是只有<code>:symbol</code>而已噢！看看以下：</p>

<pre class="highlight ruby"><code><span class="ss">:symbol</span>  
<span class="ss">:"symbol"</span>  
<span class="ss">:'symbol'</span>  
</code></pre>

<p>第二和第三行並不是新的寫法，這三行到irb中執行都會得到相同的結果：</p>

<pre class="highlight ruby"><code><span class="o">=&gt;</span> <span class="ss">:symbol</span>  
</code></pre>

<p>只是有加上引號只是方便於俱有空格的符號：</p>

<pre class="highlight ruby"><code><span class="ss">:"Hello Kitty"</span>  
<span class="o">=&gt;</span> <span class="ss">:"Hello Kitty"</span>  
  
<span class="ss">:Hello</span> <span class="no">Kitty</span>  
<span class="no">SyntaxError</span> <span class="c1">#要有空格就一定要加上引號才行，不然會噴錯！  </span>
</code></pre>

<p>如同字串有<code>%q</code>與<code>%Q</code>、陣列有<code>%w</code>與<code>%W</code>，symbol也有一個<code>%s</code>(沒有%S)的語法，例如：</p>

<pre class="highlight ruby"><code><span class="sx">%s[Hello]</span>  
<span class="o">=&gt;</span> <span class="ss">:Hello</span>  
  
<span class="sx">%s[Hello Kitty]</span>  
<span class="o">=&gt;</span> <span class="ss">:"Hello Kitty"</span>  
</code></pre>

<p>接下來書中提到symbol常被用在一個很特別的情境下，例如：如果我們要查某個物件是不是有支援<code>.each</code>這個方法？我們可以這麼做：</p>

<pre class="highlight ruby"><code><span class="p">[].</span><span class="nf">respond_to?</span> <span class="ss">:each</span>  
<span class="o">=&gt;</span> <span class="kp">true</span> <span class="c1"># 陣列有.each這方法  </span>
  
<span class="p">{}.</span><span class="nf">respond_to?</span> <span class="ss">:each</span>  
<span class="o">=&gt;</span> <span class="kp">true</span> <span class="c1"># 雜湊也有.each這方法  </span>
  
<span class="s2">""</span><span class="p">.</span><span class="nf">respond_to?</span> <span class="ss">:each</span>  
<span class="o">=&gt;</span> <span class="kp">false</span> <span class="c1"># 字串就沒有.each這方法  </span>
  
<span class="s2">""</span><span class="p">.</span><span class="nf">respond_to?</span> <span class="ss">:succ</span>  
<span class="o">=&gt;</span> <span class="kp">true</span> <span class="c1"># 不過字串有昨天提到的.succ這方法  </span>
</code></pre>

<p>總之是個很好的檢測方式，書中就給了個例子：</p>

<pre class="highlight ruby"><code><span class="nb">name</span> <span class="o">=</span> <span class="ss">:size</span>  
<span class="k">if</span> <span class="n">xxx</span><span class="p">.</span><span class="nf">respond_to?</span> <span class="nb">name</span>  
  <span class="n">xxx</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>  
<span class="k">end</span>  
</code></pre>

<p>上面這例子是會測試某物(xxx)是否會回應所指定的方法(<code>.size</code>)，如果答案是true，就調用該方法！書中指出這種能夠觀察並修改行為的程式碼稱作「反射程式碼(reflective code)」。</p>

<p>最後最後，我們來看字串與符號的轉換：
(還記得以前學過<code>.to_s</code>、<code>.to_i</code>、<code>.to_a</code>)</p>

<p>符號改成字串一樣可以使用<code>.to_s</code></p>

<pre class="highlight ruby"><code><span class="ss">:Ruby</span><span class="p">.</span><span class="nf">to_s</span>  
<span class="o">=&gt;</span> <span class="s2">"Ruby"</span>  
</code></pre>

<p>也可以用<code>.id2name</code>達到同樣的效果</p>

<pre class="highlight ruby"><code><span class="ss">:Ruby</span><span class="p">.</span><span class="nf">id2name</span>  
<span class="o">=&gt;</span> <span class="s2">"Ruby"</span>  
</code></pre>

<p>而字串改符號的話，要使用<code>.to_sym</code>或<code>.intern</code></p>

<pre class="highlight ruby"><code><span class="s2">"Ruby"</span><span class="p">.</span><span class="nf">to_sym</span>  
<span class="o">=&gt;</span> <span class="ss">:Ruby</span>  
  
<span class="s2">"Ruby"</span><span class="p">.</span><span class="nf">intern</span>  
<span class="o">=&gt;</span> <span class="ss">:Ruby</span>  
</code></pre>

<p>路過的阿嬤：『安捏喔！賀啦～哇瞭蓋啊～』</p>

<hr />

<p>第13天~對不起其實根本沒有路過的阿嬤XD</p>

<blockquote>
  <p>Always remember that the future comes one day at a time. - Dean Acheson</p>
</blockquote>

<p>未來，是一天一天的來！</p>
</div><div class="articleContent-social"><div id="fb-root"></div><script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v2.7&appId=838413066169349";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script><div class="fb-like" data-action="like" data-href="http://blog.annideas.com/ironman/2014-10-13-ruby-girl-13-ruby-string-vs-symbol/" data-layout="button_count" data-share="true" data-show-faces="true" data-size="small" data-width="700px"></div></div><div class="articleContent-paging"><a class="articleContent-paging-item articleContent-paging-item--prev" href="../2014-10-14-ruby-girl-14-ruby-object-intro/"><div class="articleContent-paging-item-title single-dot">Ruby女孩(14)：在Ruby中，萬事萬物都是物件 => true</div><div class="articleContent-paging-item-date">2014．Oct．14</div></a><a class="articleContent-paging-item articleContent-paging-item--next" href="../2014-10-12-ruby-girl-12-ruby-range-intro/"><div class="articleContent-paging-item-title single-dot">Ruby女孩(12)：Range讓我知道..我是草莓族，Ruby不是QQ</div><div class="articleContent-paging-item-date">2014．Oct．12</div></a></div><div id="disqus_thread"></div>
<script type="text/javascript">
//<![CDATA[
                  var disqus_shortname = 'otiannie5';
          
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
//]]>
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div><div class="designer">Designed with <span class="love">❤</span> by <a href="http://otischou.tw/">Otis Chou</a><script>$('.designer a').click(function(){
  ga('send', 'event', 'Footer', 'click', 'Otis Chou');
})</script></div></div><div class="menu_icon_block" data-show-menu=""><div class="menu_icon"></div></div><div class="mask" data-hide-menu=""></div><nav><img class="close" data-hide-menu="true" src="/images/cross-e391fcc8.svg" /><div class="avatar"><a href="/"><img src="/images/annie_pic-a20039dc.jpg" /></a></div><div class="social_link"><a target="_blank" href="/resume"><img class="resume" src="/images/me-123f788f.svg" /></a><a target="_blank" href="https://twitter.com/_OtiAnn"><img class="twitter" src="/images/twitter-e0f1f272.svg" /></a><a target="_blank" href="https://www.facebook.com/OtiAnn"><img class="facebook" src="/images/facebook-368929ba.svg" /></a></div><div class="desc_block"><div class="name">陳祐禎 Annie</div><div class="description">A coach of Rails Girls Taiwan, a math teacher, a Rails developer.</div></div><ul class="catgory_list"><li><a class="life" href="/categories/生活/">生活 (3)</a></li><li><a class="edu" href="/categories/學習/">學習 (4)</a></li><li><a class="dev" href="/categories/開發/">開發 (7)</a></li><li><a href="/ironman7">鐵人賽文章 (30)</a></li></ul></nav><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-51807616-2', 'auto');
ga('send', 'pageview');</script></div></body></html>